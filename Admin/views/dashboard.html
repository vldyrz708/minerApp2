<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="/css/admin-core.css" />
</head>
<body class="admin-theme min-h-screen font-sans text-gray-900">
  <div class="min-h-screen flex flex-col">
    <div id="header-container"></div>

    <main class="flex-1">
      <div class="admin-shell">
        <section class="admin-hero">
          <span class="admin-eyebrow">Panel principal</span>
          <h1>Controla la experiencia pública</h1>
          <p>Revisa cómo se ve el portal para los visitantes, crea nuevas fichas y mantén los contenidos sincronizados con un par de clics.</p>
          <div class="admin-pill-row">
            <span class="admin-pill">Cambios en vivo</span>
            <span class="admin-pill">Flujos auditados</span>
            <span class="admin-pill">Alertas inmediatas</span>
          </div>
        </section>

        <div class="admin-layout admin-layout--split">
          <section class="admin-panel admin-panel--glass">
            <div class="admin-panel__header">
              <div>
                <p class="admin-eyebrow">Vista pública</p>
                <h2>Directorio en vivo</h2>
                <p class="admin-muted">Explora el sitio exactamente como lo ve un visitante antes de publicar cambios.</p>
              </div>
              <div class="admin-toolbar__actions">
                <button id="reloadPreview" class="admin-btn admin-btn--ghost text-xs">Recargar</button>
                <button id="fullscreenPreview" class="admin-btn admin-btn--ghost text-xs">Pantalla completa</button>
                <button id="openPreview" class="admin-btn admin-btn--primary text-xs">Abrir</button>
              </div>
            </div>
            <div class="admin-preview-frame">
              <iframe id="previewFrame" src="/" title="Vista previa del sitio público"></iframe>
            </div>
            <p class="admin-muted mt-3 text-sm">Interactúa con los elementos para validar journeys. Usa “Abrir” si necesitas depurar en una pestaña aparte.</p>
          </section>

          <section class="admin-panel admin-card-stack">
            <article class="admin-card-list__item">
              <p class="admin-eyebrow">Bienvenida</p>
              <h3 class="text-xl font-semibold">Panel de gobierno</h3>
              <p class="admin-muted">Gestiona lugares, categorías, reseñas y accesos con el mismo lenguaje visual que ve el usuario.</p>
            </article>

            <article class="admin-card-list__item">
              <p class="admin-eyebrow">Acciones rápidas</p>
              <div class="admin-quick-actions">
                <a href="/admin/lugares" class="admin-btn admin-btn--primary w-full text-center">Ver lugares</a>
                <a href="/admin/lugares/nuevo" class="admin-btn admin-btn--muted w-full text-center">Crear lugar</a>
                <button id="dashAddCategoria" class="admin-btn admin-btn--ghost w-full">Agregar categoría</button>
              </div>
            </article>

            <article class="admin-card-list__item">
              <p class="admin-eyebrow">Soporte</p>
              <h3 class="text-lg font-semibold">¿Necesitas ayuda?</h3>
              <p class="admin-muted">Escríbenos si detectas incidencias o consulta la documentación para integraciones avanzadas.</p>
              <div class="admin-pill-row mt-2">
                <span class="admin-pill">Documentación</span>
                <span class="admin-pill">Canal directo</span>
              </div>
            </article>
          </section>
        </div>
      </div>
    </main>
  </div>

  <script src="/js/admin.js"></script>
  <script>
    // preview controls
    document.getElementById('reloadPreview')?.addEventListener('click', () => {
      const f = document.getElementById('previewFrame');
      if (f) {
        f.src = f.src.split('#')[0].split('?')[0] + '?t=' + Date.now();
      }
    });
    document.getElementById('openPreview')?.addEventListener('click', () => {
      window.open('/', '_blank');
    });

    // Botón rápido para ir a categorías
    document.getElementById('dashAddCategoria')?.addEventListener('click', () => {
      window.location.href = '/admin/categorias';
    });
  </script>
  
  <script>
    // Fullscreen overlay for preview
    (function(){
      const overlay = document.createElement('div');
      overlay.id = 'previewOverlay';
      Object.assign(overlay.style, {
        position: 'fixed', top: '24px', left: '24px', right: '24px', bottom: '24px',
        background: 'rgba(255,255,255,0.98)', zIndex: '9999', boxShadow: '0 10px 50px rgba(0,0,0,0.3)',
        borderRadius: '8px', display: 'none', padding: '12px', overflow: 'hidden'
      });
      overlay.innerHTML = `
        <div style="height:100%; display:flex; flex-direction:column;">
          <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
            <div style="font-weight:600">Vista previa - Pantalla completa</div>
            <div>
              <button id="overlayClose" style="margin-right:8px; padding:6px 10px; border-radius:6px; border:1px solid #ddd; background:#fff">Cerrar (Esc)</button>
              <button id="overlayOpenNew" style="padding:6px 10px; border-radius:6px; background:#2563eb; color:#fff; border:0">Abrir en nueva ventana</button>
            </div>
          </div>
          <div style="flex:1; border:1px solid #e5e7eb; border-radius:6px; overflow:hidden; background:#fff">
            <iframe id="overlayFrame" src="/" style="width:100%; height:100%; border:0"></iframe>
          </div>
        </div>
      `;
      document.body.appendChild(overlay);

      const btn = document.getElementById('fullscreenPreview');
      if (btn) btn.addEventListener('click', () => {
        overlay.style.display = 'block';
        const f = document.getElementById('overlayFrame');
        const src = document.getElementById('previewFrame')?.src || '/';
        if (f && src) f.src = src.split('?')[0] + '?t=' + Date.now();
      });

      document.getElementById('overlayClose')?.addEventListener('click', () => { overlay.style.display = 'none'; });
      document.getElementById('overlayOpenNew')?.addEventListener('click', () => { window.open('/', '_blank'); });

      document.addEventListener('keydown', (e) => { if (e.key === 'Escape') overlay.style.display = 'none'; });
    })();
  </script>
</body>
</html>